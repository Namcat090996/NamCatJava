/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package danhsachsinhvien;

import java.awt.event.ActionListener;
import java.util.List;
import javax.swing.ButtonGroup;
import javax.swing.JButton;
import javax.swing.JOptionPane;
import javax.swing.JRadioButton;

/**
 *
 * @author ADMIN
 */
public class fmAddSinhVien extends javax.swing.JFrame {

    private String maSV = "";
 
    public String getMaSV() {
	return maSV;
    }

    public void setMaSV(String maSV) {
	this.maSV = maSV;
    }   
    
    /**
     * Creates new form fmAddSinhVien
     */
    public fmAddSinhVien() {
	initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        btnGrGioiTinh = new javax.swing.ButtonGroup();
        jPanel1 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        txtMaSinhVien = new javax.swing.JTextField();
        txtHoTen = new javax.swing.JTextField();
        txtDienThoai = new javax.swing.JTextField();
        txtEmail = new javax.swing.JTextField();
        txtDiaChi = new javax.swing.JTextField();
        rb1 = new javax.swing.JRadioButton();
        rb2 = new javax.swing.JRadioButton();
        btnCapNhat = new javax.swing.JButton();
        btnDong = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowOpened(java.awt.event.WindowEvent evt) {
                formWindowOpened(evt);
            }
        });

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Nhập thông tin sinh viên", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 1, 12))); // NOI18N

        jLabel2.setText("Mã sinh viên:");

        jLabel3.setText("Họ tên:");

        jLabel4.setText("Giới tính:");

        jLabel5.setText("Điện thoại:");

        jLabel6.setText("Email:");

        jLabel7.setText("Địa chỉ:");

        txtEmail.setText(" ");

        txtDiaChi.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtDiaChiActionPerformed(evt);
            }
        });

        btnGrGioiTinh.add(rb1);
        rb1.setText("Nam");

        btnGrGioiTinh.add(rb2);
        rb2.setText("Nữ");

        btnCapNhat.setText("Cập nhật");
        btnCapNhat.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCapNhatActionPerformed(evt);
            }
        });

        btnDong.setText("Đóng");
        btnDong.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnDongActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(50, 50, 50)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel2)
                    .addComponent(jLabel3)
                    .addComponent(jLabel4)
                    .addComponent(jLabel5)
                    .addComponent(jLabel6)
                    .addComponent(jLabel7))
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(rb1)
                        .addGap(36, 36, 36)
                        .addComponent(rb2))
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                        .addGroup(jPanel1Layout.createSequentialGroup()
                            .addComponent(btnCapNhat)
                            .addGap(23, 23, 23)
                            .addComponent(btnDong))
                        .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(txtDiaChi, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 315, Short.MAX_VALUE)
                            .addComponent(txtEmail, javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtDienThoai, javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtHoTen, javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtMaSinhVien, javax.swing.GroupLayout.Alignment.LEADING))))
                .addContainerGap(43, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(29, 29, 29)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(txtMaSinhVien, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel3)
                    .addComponent(txtHoTen, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel4)
                    .addComponent(rb1)
                    .addComponent(rb2))
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel5)
                    .addComponent(txtDienThoai, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel6)
                    .addComponent(txtEmail, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel7)
                    .addComponent(txtDiaChi, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnCapNhat)
                    .addComponent(btnDong))
                .addContainerGap(17, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(20, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(17, 17, 17)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(19, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void txtDiaChiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtDiaChiActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtDiaChiActionPerformed

    private void btnCapNhatActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCapNhatActionPerformed
        
	//Declare new value to add/update in the list
	String maSV = "", hoTen = "", dienThoai = "", gioiTinh = "", email = "", diaChi = "";
	
	//Take user information entered from the keyboard
	maSV = txtMaSinhVien.getText().trim();
	hoTen = txtHoTen.getText().trim();
	dienThoai = txtDienThoai.getText().trim();
	email = txtEmail.getText().trim();
	diaChi = txtDiaChi.getText().trim();
	
	//Use If-Else to catch the error when users don't enter the value on the interface
	//Mã sinh viên
	int x = 0;
	
	//"Mã sinh viên" must be no less than 5 characters and x must be an integer
	try 
	{  
	    x = Integer.parseInt(maSV.substring(4));
	} 
	catch (Exception e) 
	{
	    JOptionPane.showMessageDialog(rootPane, "Mã sinh viên không hợp lệ");
	    txtMaSinhVien.requestFocus();
	    return;	
	}
	
	//"Mã sinh viên" must be in the correct format
	if(!maSV.equals("SF00" + Integer.toString(x)))
	{
	    JOptionPane.showMessageDialog(rootPane, "Mã sinh viên không hợp lệ");
	    txtMaSinhVien.requestFocus();
	    return;
    
	}
	
	if(maSV.length() == 0)
	{
	    JOptionPane.showMessageDialog(rootPane, "Bạn phải nhập mã sinh viên");
	    txtMaSinhVien.requestFocus();
	    return;
	}
	
	//Họ tên
	if(hoTen.length() == 0)
	{
	    JOptionPane.showMessageDialog(rootPane, "Bạn phải nhập họ tên sinh viên");
	    txtHoTen.requestFocus();
	    return;
	}
	
	if(hoTen.contains("  "))
	{
	    JOptionPane.showMessageDialog(rootPane, "Tên không hợp lệ");
	    txtHoTen.requestFocus();
	    return;	    
	}
	
	//Check if "Họ tên" contains digit
	char hoTenCheck[] = hoTen.toCharArray();
	
	for(char giaTri: hoTenCheck)
	{
	    if(Character.isDigit(giaTri))
	    {
		JOptionPane.showMessageDialog(rootPane, "Tên không hợp lệ");
		txtHoTen.requestFocus();
		return;
	    }	    
	}
	
	//Điện thoại
	if(dienThoai.length() == 0)
	{
	    JOptionPane.showMessageDialog(rootPane, "Bạn phải nhập số điện thoại sinh viên");
	    txtDiaChi.requestFocus();
	    return;
	}

	if(dienThoai.contains(" "))
	{
	    JOptionPane.showMessageDialog(rootPane, "Số điện thoại không hợp lệ");
	    txtDienThoai.requestFocus();
	    return;	    
	}
	//Check if "Điện thoại" contains letter
	char dienThoaiCheck[] = dienThoai.toCharArray();
	
	for(char giaTri: dienThoaiCheck)
	{
	    if(Character.isLetter(giaTri))
	    {
		JOptionPane.showMessageDialog(rootPane, "Số điện thoại không hợp lệ");
		txtDienThoai.requestFocus();
		return;
	    }	    
	}
	
	//Giới tính
	if(rb1.isSelected())
	{
	    gioiTinh = "Nam";
	}
	else
	{
	    if(rb2.isSelected())
	    {
		gioiTinh = "Nữ";
	    }
	    else
	    {
		JOptionPane.showMessageDialog(rootPane, "Bạn phải chọn giới tính sinh viên");
		return;
	    }	    
	}
	
	//Email
	if(email.length() == 0)
	{
	    JOptionPane.showMessageDialog(rootPane, "Bạn phải nhập mail sinh viên");
	    txtEmail.requestFocus();
	    return;
	}
	
	//Địa chỉ
	if(diaChi.length() == 0)
	{
	    JOptionPane.showMessageDialog(rootPane, "Bạn phải nhập địa chỉ sinh viên");
	    txtDiaChi.requestFocus();
	    return;
	}
	
	//Declare object to contain data
	SinhVien objSV = new SinhVien();
	
	//Assgin values to object
	objSV.setMaSV(maSV);
	objSV.setHoTen(hoTen);
	objSV.setDienThoai(dienThoai);
	objSV.setGioiTinh(gioiTinh);
	objSV.setEmail(email);
	objSV.setDiaChi(diaChi);
	
	//Declare object to check the duplicate value
	boolean kiemTraTrung = DataProvider.getSinhVienBus().kiemTraTrungMaSV(maSV);
		
	if(!this.maSV.isEmpty())
	{
	    List<SinhVien> lstSV = DataProvider.getSinhVienBus().capNhat(objSV);
	    JOptionPane.showMessageDialog(rootPane, "Cập nhật thông tin sinh viên thành công");	    
	}
	else
	{
	    if(kiemTraTrung == true)
	    {
		List<SinhVien> lstSV = DataProvider.getSinhVienBus().themMoi(objSV);
		JOptionPane.showMessageDialog(rootPane, "Thêm mới thông tin sinh viên thành công");
	    }
	    else
	    {
		JOptionPane.showMessageDialog(rootPane, "Mã sinh viên này đã tồn tại. Vui lòng nhập lại mã sinh viên");
		txtMaSinhVien.requestFocus();
		return;
	    }	    
	}

	//Reload the form
	fmDanhSachSinhVien.hienThiDanhSachSinhVien();
		
    }//GEN-LAST:event_btnCapNhatActionPerformed

    private void btnDongActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDongActionPerformed
	//Close the form
	this.setVisible(false);
    }//GEN-LAST:event_btnDongActionPerformed

    private void formWindowOpened(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowOpened
        // TODO add your handling code here:
	if(!maSV.isEmpty())
	{
	    //In case of editing
	    hienThiChiTietSinhVien();
	    this.setTitle("Sửa thông tin sinh viên");
	}
	else
	{
	    txtMaSinhVien.setText("SF00");
	    this.setTitle("Thêm mới thông tin sinh viên");
	}
    }//GEN-LAST:event_formWindowOpened

    public void hienThiChiTietSinhVien()
    {
	//Declare object to contain data
	SinhVien objSV = DataProvider.getSinhVienBus().layChiTiet(maSV);
	
	if(objSV != null)
	{
	    //Show object on the interface
	    txtMaSinhVien.setText(maSV);
	    txtHoTen.setText(objSV.getHoTen());
	    txtDienThoai.setText(objSV.getDienThoai());
	    if(objSV.getGioiTinh().equals("Nam"))
	    {
		rb1.setSelected(true);
	    }
	    else
	    {
		rb2.setSelected(true);
	    }
	    txtEmail.setText(objSV.getEmail());
	    txtDiaChi.setText(objSV.getDiaChi());	    
	}
    }
    
    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
	/* Set the Nimbus look and feel */
	//<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
	/* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
	 */
	try {
	    for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
		if ("Nimbus".equals(info.getName())) {
		    javax.swing.UIManager.setLookAndFeel(info.getClassName());
		    break;
		}
	    }
	} catch (ClassNotFoundException ex) {
	    java.util.logging.Logger.getLogger(fmAddSinhVien.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
	} catch (InstantiationException ex) {
	    java.util.logging.Logger.getLogger(fmAddSinhVien.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
	} catch (IllegalAccessException ex) {
	    java.util.logging.Logger.getLogger(fmAddSinhVien.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
	} catch (javax.swing.UnsupportedLookAndFeelException ex) {
	    java.util.logging.Logger.getLogger(fmAddSinhVien.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
	}
	//</editor-fold>

	/* Create and display the form */
	java.awt.EventQueue.invokeLater(new Runnable() {
	    public void run() {
		new fmAddSinhVien().setVisible(true);
	    }
	});
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnCapNhat;
    private javax.swing.JButton btnDong;
    private javax.swing.ButtonGroup btnGrGioiTinh;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JRadioButton rb1;
    private javax.swing.JRadioButton rb2;
    private javax.swing.JTextField txtDiaChi;
    private javax.swing.JTextField txtDienThoai;
    private javax.swing.JTextField txtEmail;
    private javax.swing.JTextField txtHoTen;
    private javax.swing.JTextField txtMaSinhVien;
    // End of variables declaration//GEN-END:variables
}
